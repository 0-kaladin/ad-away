Forked from the following sources and slightly modified to compile!

dnsmasq:  https://github.com/CyanogenMod/android_external_dnsmasq
libpcap: https://github.com/CyanogenMod/android_external_libpcap
tcpdump: https://github.com/CyanogenMod/android_external_tcpdump

tcpdump/Android.mk changed:
LOCAL_C_INCLUDES += \
	$(LOCAL_PATH)/missing\
	$(LOCAL_PATH)/../libpcap

# disabled crypo libs, not needed in AdAway
#	$(LOCAL_PATH)/../openssl/include\

#LOCAL_SHARED_LIBRARIES += libssl libcrypto


In tcpdump/config.h changed:

/* Whether or not to include the possibly-buggy SMB printer */
/* #undef TCPDUMP_DO_SMB */

/* Define to 1 if you have the <openssl/evp.h> header file. */
/* #undef HAVE_OPENSSL_EVP_H */

/* Define to 1 if you have the `crypto' library (-lcrypto). */
/* #undef HAVE_LIBCRYPTO */